### 프로세스와 쓰레드, 멀티쓰레드
프로세스와 스레드에대해서는 항상 들어왔지만 멀티쓰레드란 무엇일까? 우선 프로세스와 스레드에대해 집고 넘어가자. 프로세스는 운영체제(OS)로 부터 자원을 할당받는 작업의 단위이고, 스레드는 프로세스가 할당받은 자원을 이용하는 실행의 단위이다.  
  1. 프로세스
    실행중인 프로그램으로 디스크로부터 메모리에 적재되어 CPU의 할당을 받을 수 있는 것을 말한다. 운영체제로부터 주소공간, 파일, 메모리 등을 할당받으며 이것들을 총칭하여 프로세스라고 한다.
  1. 스레드
    프로세스의 실행 단위이다. 한 프로세스 내에서 동작되는 여러 실행 흐름으로 프로세스 내의 주소 공간이나 자원을 공유할 수 있다. (경량화된 프로세스 = 쓰레드)   
💡 이 때, 하나의 프로세스를 다수의 실행 단위로 구분하여 자원을 공유하고 자원의 생성과 관리의 중복성을 최소화 하여 수행 능력을 향상시키는 것을 멀티스레딩(MultiThreading) 이라고 한다. 이 경우 각각의 스레드는 독립적인 작업을 수행해야 하기 때문에 각자의 스택과 레지스터값을 갖고 있다.

### 싱글 쓰레드 vs 멀티 쓰레드
싱글 쓰레드는 순차 실행 / 멀티 쓰레드는 병행

### 멀티 프로세스 vs 멀티 쓰레드
멀티 프로세스는 [데이터, 힙, 스택]영역 모두를 비공유하고,  
멀티 쓰레드는 [데이터, 힙, 스텍]영역중 스택 영역만 비공유한다.

### 멀티 스레딩의 장점
프로세스를 이용하여 동시에 처리하던 일을 스레드로 구현할 경우 메모리 공간과 시스템 자원 소모가 줄어들게 된다. 스레드 간의 통신이 필요한 경우에도 별도의 자원을 이용하는 것이 아니라 전역변수의 공간 또는 동적으로 할당된 공간인 Heap 영역을 이용하여 데이터를 주고받을 수 있다. 떼문에 프로세스 간 통신보다 스레드 간 통신이 훨씬 간편하다. 또한 스레드의 문맥 교환은 캐시 메모리를 비울 필요가 없기 때문에 더 빠르기도 하다. 따라서 시스템의 네트워크 출력(단위시간당 처리할수 있는 데이터에대한 지표)이 향상되고 자원 소모가 줄어들면서 결과적으로 프로그램의 응답시간이 단축된다. 이러한 장점 때문에 여러 프로세스로 할 수 있는 작업들을 하나의 프로세스에서 스레드로 나누어 수행한다. 또한 프로그램의 일부분(쓰레드)이 중단되거나 오류가 나도라도 프로그램의 전체적인 부분에 가하는 영향이 줄어들고 마찬가지로 다른 스레드가 작업중에 또 다른 스레드를 통해 사용자와 상호작용이 가능해서 응답성이 좋아진다.

### 멀티 스레딩의 단점
멀티 프로세스 기반으로 프로그래밍을할 때는 프로세스간 공유하는 자원이 없기 때문에 동일한 자원에 동시에 접근하는 일이 없지만, 멀티 스레딩을 기반으로 프로그래밍을 할 때는 서로 다른 스레드가 데이터와 Heap영역을 공유하기 때문에 어떤 스레드가 다른 스레드에서 사용중인 변수느 자료구조에 접근하여 엉뚱한 값을 읽어오가너 수정할 수 있다. 때문에 멀티스레딩 환경에서는 동기화 작업이 반드시 필요하다. 동기화를 통해 작업처리 순서를 컨트롫하고 공유자원에 대한 접근을 컨트롤 하는 것이다. 하지만 이로인한 병목현상이 발생하여 성능저하고 이어질 수 있기 때문에 과도한 락으로 인한 병목현상을 줄이기 위해 공유 자원이 아닌 부분은 동기화 처리를 하지 않고, 동기화처리가 필요한 부분에만 Synchronized 키워드를 통해 동기화해야 한다. 

### 안드로이드에서 쓰레드!
앱이 실행되고 기본적으로 하나의 프로세스가 생성되면 하나의 Main Thread(UI Thread)가 생성된다. 만약 Main Thread의 작업시간이 길어지거나, 네트워크 요청 등이 발생하면 안드로이드 플랫폼에서 앱이 중단되었다고 판당하여 ANR(Application Not Responding) 대화상자를 띄워서 사용자에게 앱을 종료할 것인지를 물어본다. 때문에 시간이 많이 걸리는 일이나 Network작업은 ANR이 발생하지 않도록 추가로 Sub Thread를 생성하여 처리해야한다. 다만! UI변경에 대한 작업은 오직 Main Thread(UI Thread)에서 만 가능하다.

+ 안드로이드에서 Thread 생성하는 2가지방법
  ```JAVA
  // 1. extends Thread
  class MyThread extends Thread{
  @Override
    public void run() {
      super.run();
      // 코딩 내용
    }
  }
  
  // 2. implements Runnable
  class MyRun implements Runnable {
  @Override
    public void run(){
    // 코딩 내용
    }
  }
  ```
  
이 외에 Handler를 다루거나 AsyncTask 등의 내용은 개인적으로 진행한 프로젝트에서 확인하자 [📌](https://github.com/h0keun/Thread/blob/main/README.md)

### 참고
[안드로이드 공식 - 스레딩을 통한 성능 개선](https://developer.android.com/topic/performance/threads?hl=ko) / [안드로이드 공식 - 백그라운드 스레드에서 android 작업 실행](https://developer.android.com/guide/background/threading?hl=ko)
[1️⃣ OS 관점에서](https://asfirstalways.tistory.com/340)
[2️⃣ Android 관점에서](https://m.blog.naver.com/PostView.nhn?blogId=wow2778&logNo=221016693320&proxyReferer=https:%2F%2Fwww.google.com%2F)

### 본글에는 참고하지는 않았지만 함께 보면 좋은 사이트
[1️⃣](https://honbabzone.com/java/java-thread/)
[2️⃣](https://ict-nroo.tistory.com/41)
[3️⃣](https://recipes4dev.tistory.com/143?category=768056)
[4️⃣](https://developer88.tistory.com/72)
